# 仮想インターネット通信システム

*   **IPvMアドレス**: TCP/IPベースの仮想アドレスシステム。形式: `[種類]-UUID`
    - `0-{Player_UUID}`: プレイヤー
    - `1-{Entity_UUID}`: デバイス(エンティティ) ※現在未使用
    - `2-{登録式識別ID}`: サーバー(外部Mod)
    - `3-{登録式識別ID}`: システム(本Mod)
*   **仮想ルーター**: 本プログラムがルーター機能を提供し、送信先に応じた適切なルーティングを実行
*   **通信方式**:
    - プレイヤー向け: IPからPlayerUUIDを抽出し、Minecraftパケットとして送信
    - サーバー(外部Mod)向け: レジストリに登録されたMod APIを叩いて通信
    - システム向け: 本Mod内部で直接処理
*   **ユースケース**:
    1. アプリケーションインストール要求 (クライアント→システム)
    2. 電子マネー処理 (クライアント→外部Modサーバー→クライアント)
    3. メッセージ送信 (クライアント→クライアント)

- **仮想インターネット通信システムの実装** (✅ 100%完了):
  1. **coreモジュール**:
     - `IPvMAddress`: アドレス表現クラス (✅)
     - `VirtualPacket`: パケットデータクラス (✅)
     - `VirtualRouter`: ルーティングサービス（Kernelサービスとして登録） (✅)
     - `MessageStorage`: メッセージ永続化サービス (✅)
  2. **forgeモジュール**:
     - Minecraftパケット通信（プレイヤー間通信） (✅)
     - 外部Mod登録API (`VirtualNetworkRegistry`) (✅)
     - システム通信ハンドラー（`SystemPacketHandler`） (✅)
     - メッセージ処理の完全実装 (✅)
  3. **統合**:
     - `NetworkHandler`: ForgeのSimpleChannelを使ったパケット送受信 (✅)
     - `MochiMobileOSMod`: ネットワーク初期化 (✅)
     - `SmartphoneBackgroundService`: VirtualRouter初期化 (✅)
  4. **アプリケーション**:
     - `NetworkApp`: メッセージ送受信とネットワークテスト機能 (✅)
     - メッセージ一覧表示、テスト送信、システムパケット送信 (✅)
  5. **ドキュメント**:
     - `VIRTUAL_NETWORK_API.md`: 外部Mod連携APIドキュメント (✅)
     - 完全なサンプルコード（電子マネーサービス）を含む (✅)

- **仮想インターネット通信システムのテスト** (✅ 完了):
  - NetworkAppの「Send Test Message」ボタンでメッセージ送信テストを実施
  - マルチプレイヤー環境（LAN公開）でテスト完了
  - 全プレイヤーがメッセージを受信できることを確認
  - メッセージ通知機能が正常に動作することを確認
  - **注意**: 現在の実装では、`NetworkScreen.sendTestMessage()`は自分自身（UUID: `00000000-0000-0000-0000-000000000000`）宛てにメッセージを送信している。統合サーバー環境では全クライアントにブロードキャストされるため問題なく動作するが、将来的には適切なプレイヤーUUIDを使用する必要がある
